svm.num.cells=NULL, svm.train.inds=NULL, svm.max=5000,
n.cores=2, k.means.nstart=NULL,
k.means.iter.max=1e+09, biology=TRUE, seed=321)
sc3_interactive(baz)
baz <- sc3_summarise_results(baz, k=2)
plotTSNE(baz, ntop=1000, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
plotTSNE(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
plotPCA(baz, ntop=1000, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
plotPCA(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
sc3_plot_expression(baz, k=2, show_pdata=c("clusCT","sc3_clusters"))
foo <- readRDS("/Users/ricard/git/gastrulation/expr/sc3.rds")
bar <- foo[,pData(foo)$stage=="E6.5" & pData(foo)$clusCT!="TB"]
genes <- names(tail(sort(apply(exprs(bar),1,var)),n=1000))
bar <- bar[genes,]
pdata <- pData(bar)
View(pdata)
baz <- sc3(bar, exprs_values="exprs", ks=2:4,
gene.filter=FALSE, gene.filter.fraction=NULL, gene.reads.rare=2, gene.reads.ubiq=0,
log.scale=FALSE, d.region.min=0.04, d.region.max=0.07,
svm.num.cells=NULL, svm.train.inds=NULL, svm.max=5000,
n.cores=2, k.means.nstart=NULL,
k.means.iter.max=1e+09, biology=TRUE, seed=321)
sc3_interactive(baz)
baz <- sc3_summarise_results(baz, k=2)
plotPCA(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
baz <- sc3_summarise_results(baz, k=3)
# PCA
plotPCA(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
plotPCA(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
plotTSNE(baz, ntop=500, ncomponents=2, colour_by="sc3_clusters", shape_by="clusCT")
sc3_plot_expression(baz, k=4, show_pdata=c("clusCT","sc3_clusters"))
sc3_plot_expression(baz, k=3, show_pdata=c("clusCT","sc3_clusters"))
sc3_plot_expression(baz, k=4, show_pdata=c("clusCT","sc3_clusters"))
genes <- c("Sp5", "T", "Sall3", "Lef1", "Evx1", "Snai1", "Irx3", "Hmga1-rs1", "Rai1", "Pbx1", "Zfp358", "Uhrf2", "Cbx2", "Gli3")
?sc3_plot_expression
tmp <- baz[genes,]
genes
meta <- read.table("/Users/ricard/data/ensembl/mouse/v87/mRNA/Mmusculus_genes_BioMart.87.txt", header=T)
meta <- read.table("/Users/ricard/data/ensembl/mouse/v87/mRNA/Mmusculus_genes_BioMart.87.txt", header=T, sep="\t")
View(meta)
?read.table
meta <- read.csv("/Users/ricard/data/ensembl/mouse/v87/mRNA/Mmusculus_genes_BioMart.87.txt", header=T, sep="\t", stringsAsFactors=F)
View(meta)
View(meta)
subset(meta,symbol %in% genes)
meta_filt <- subset(meta,symbol %in% genes)
length(genes)
View(meta_filt)
View(meta_filt)
ens_id <- subset(meta,symbol %in% genes)$ens_id
ens_id
tmp <- baz[ens_id,]
rownames(baz)
tmp <- baz[rownames(ens_id) %in% ens_id,]
tmp
ens_id
tmp <- foo[rownames(ens_id) %in% ens_id,]
tmp
foo
rownames(foo)
library(dplyr)
library(tidyr)
library(scater)
library(SC3)
sce <- readRDS("/Users/ricard/data/gastrulation/expr/processed/expr_sceset.rds")
sce <- sce[,pData(sce)$stage=="E6.5"]
sce$sample <- colnames(sce)
sce <- sc3(sce, ks=2:4, gene_filter=TRUE, pct_dropout_min=10, pct_dropout_max=90, n_cores=2, biology=TRUE)
sc3_plot_consensus(sce, k=2)
sc3_plot_consensus(sce, k=3)
sc3_plot_consensus(sce, k=4)
plotTSNE(sce, ntop=1500, ncomponents=2, colour_by="sc3_2_clusters", shape_by="clusCT")
plotTSNE(sce, ntop=1500, ncomponents=2, colour_by="sc3_3_clusters", shape_by="clusCT")
plotTSNE(sce, ntop=1500, ncomponents=2, colour_by="sc3_4_clusters", shape_by="clusCT")
plotPCA(sce, ntop=1500, ncomponents=2, colour_by="sc3_2_clusters", shape_by="clusCT")
plotPCA(sce, ntop=1500, ncomponents=3, colour_by="sc3_2_clusters", shape_by="clusCT")
plotPCA(sce, ntop=1500, ncomponents=2, colour_by="sc3_3_clusters", shape_by="clusCT")
sc3_plot_expression(sce, k=2, show_pdata=c("clusCT","sc3_2_clusters"))
sc3_plot_expression(sce, k=3, show_pdata=c("clusCT","sc3_3_clusters"))
sc3_plot_expression(sce, k=4, show_pdata=c("clusCT","sc3_4_clusters"))
?sc3_plot_expression
trophobolast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
sc3_plot_expression(sce[trophoblast_genes,], k=2)
trophobolast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
sc3_plot_expression(sce[trophoblast_genes,], k=2)
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
sc3_plot_expression(sce[trophoblast_genes,], k=2)
sce[trophoblast_genes,]
?pheatmap
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
# sc3_plot_expression(sce[trophoblast_genes,], k=2)
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE)
?sc3_plot_expression(sce, k=4, show_pdata=c("clusCT","sc3_4_clusters"))
trophoblast_cells <- apply(exprs(sce[trophoblast_genes,]), 1, function(x) sum(x>0))
trophobolast_cells
trophoblast_cells
trophoblast_cells <- apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0))
trophoblast_cells
apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == 4
which(apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == 4)
apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == 4
trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == 4]
trophoblast_cells
sce$clusCT == "TB"
colnames(sce)[sce$clusCT == "TB"]
trophoblast_cells
sce
View(pData(sce))
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE)
trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == 4]
trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == len(trophoblast_genes)]
trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == length(trophoblast_genes)]
trophoblast_cells <- colnames(sce)[apply(counts(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == length(trophoblast_genes)]
asd = readRDS("/Users/ricard/data/gastrulation/expr/processed/expr_sceset.rds")
dim(asd)
primitivestreak_genes <- c("T","Snai1", "Lef1", "Evx1", "Mesp1","Sp5","Irx3")
pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE)
pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2,
show_rownames = TRUE, show_colnames = FALSE)
?pheatmap
pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2,
show_rownames = TRUE, show_colnames = FALSE)
primitivestreak_genes <- c("T","Snai1", "Lef1", "Evx1", "Mesp1","Sp5")
pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2,
show_rownames = TRUE, show_colnames = FALSE)
asd <- pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2, show_rownames = TRUE, show_colnames = FALSE)
primitivestreak_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) => length(trophoblast_genes)]
heatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2, show_rownames = TRUE, show_colnames = FALSE)
pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2, show_rownames = TRUE, show_colnames = FALSE)
asd <- pheatmap::pheatmap(exprs(sce[primitivestreak_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=2, show_rownames = TRUE, show_colnames = FALSE)
asd
names(asd)
asd$tree_col
class(asd$tree_col)
?hclust
cutree(asd$tree_col,2)
cutree(asd$tree_col,2) == 2
primitivestreak_cells <- names(which(cutree(asd$tree_col,2) == 2))
primitivestreak_cells
sce <- readRDS("/Users/ricard/data/gastrulation/expr/processed/expr_sceset.rds")
sce <- sce[,pData(sce)$stage=="E4.5"]
sce$sample <- colnames(sce)
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE)
colnames(sce)[sce$clusCT == "TB"]
?pheatmap
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
tmp <- data.frame(sample=colnames(sce), tb=sce$clusCT == "TB")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE, annotation_col=tmp)
tmp
tmp <- data.frame(sample=colnames(sce), tb=sce$clusCT == "TB") %>% tibble::column_to_rownames("sample"")
""
tmp <- data.frame(sample=colnames(sce), tb=sce$clusCT == "TB") %>% tibble::column_to_rownames("sample")
View(tmp)
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE, annotation_col=tmp)
exprs(sce[trophoblast_genes,])
rownames(tmp)
tmp$tb
tmp <- data.frame(sample=colnames(sce), tb=factor(sce$clusCT == "TB")) %>% tibble::column_to_rownames("sample")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE, annotation_col=tmp)
View(tmp)
sce <- readRDS("/Users/ricard/data/gastrulation/expr/processed/expr_sceset.rds")
sce <- sce[,pData(sce)$stage=="E5.5"]
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
tmp <- data.frame(sample=colnames(sce), tb=factor(sce$clusCT == "TB")) %>% tibble::column_to_rownames("sample")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE, annotation_col=tmp)
# trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == length(trophoblast_genes)]
# colnames(sce)[sce$clusCT == "TB"]
# Run sc3
```{r, cache=T}
sce <- sc3(sce, ks=2, gene_filter=TRUE, pct_dropout_min=10, pct_dropout_max=90, n_cores=1, biology=TRUE)
trophoblast_genes <- c("Elf5", "Wnt7b", "Tex19.1", "Eomes")
tmp <- data.frame(sample=colnames(sce), tb=factor(sce$clusCT == "TB")) %>% tibble::column_to_rownames("sample")
pheatmap::pheatmap(exprs(sce[trophoblast_genes,]), cluster_cols = TRUE, kmeans_k=NA, cutree_cols=NA,
show_rownames = TRUE, show_colnames = FALSE, annotation_col=tmp)
# trophoblast_cells <- colnames(sce)[apply(exprs(sce[trophoblast_genes,]), 2, function(x) sum(x>0)) == length(trophoblast_genes)]
# colnames(sce)[sce$clusCT == "TB"]
sce <- sc3(sce, ks=2, gene_filter=TRUE, pct_dropout_min=10, pct_dropout_max=90, n_cores=1, biology=TRUE)
sc3_plot_consensus(sce, k=2)
plotTSNE(sce, ntop=1000, ncomponents=2, colour_by="sc3_2_clusters", shape_by="clusCT")
plotPCA(sce, ntop=1000, ncomponents=2, colour_by="sc3_2_clusters", shape_by="clusCT")
sc3_plot_expression(sce, k=2, show_pdata=c("clusCT","sc3_2_clusters"))
sc3_plot_markers(sce, k=2, auroc=0.90, p.val=1e-10, show_pdata=c("clusCT","sc3_2_clusters"))
sc3_plot_de_genes(sce, k=2, p.val=1e-10, show_pdata=c("clusCT","sc3_2_clusters"))
sc3_plot_de_genes(sce, k=2, p.val=1e-5, show_pdata=c("clusCT","sc3_2_clusters"))
colnames(filter(sce, clusCT=="PE" & sc3_2_clusters==2))
outliers <-c("E5.5_embryo1_cell55","E5.5_embryo1_cell7")
sce$outlier <- (colnames(sce) %in% outliers)
plotTSNE(sce, ntop=1000, ncomponents=2, colour_by="outlier", shape_by="clusCT")
plotPCA(sce, ntop=1000, ncomponents=2, colour_by="outlier")
sc3_plot_expression(sce, k=2, show_pdata=c("outlier"))
sc3_plot_markers(sce, k=2, auroc=0.90, p.val=10e-5, show_pdata=c("outlier"))
sce <- readRDS("~/data/gastrulation/expr/processed/expr_sceset.rds")
sce$stage=="E6.5"
colnames(sce)[sce$stage=="E6.5"]
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
E3.5 <- exprs(filter(sce,stage=="E3.5"))
E4.5 <- exprs(filter(sce,stage=="E4.5"))
E5.5 <- exprs(filter(sce,stage=="E5.5"))
E6.5 <- exprs(filter(sce,stage=="E6.5"))
E6.5
dim(E6.5)
dim(E5.5)
dim(E4.5)
dim(E3.5)
?write.table
write.table(E3.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E3.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E4.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E4.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E5.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E5.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
```{r}
source("/Users/ricard/git/scGFA/R/R/loadModel.R")
file = "/Users/ricard/git/gastrulation/expr/scGFA/expr/out/out.hdf5"
model <- loadModel(file)
file = "/Users/ricard/git/gastrulation/expr/scGFA/expr/out/out0.hdf5"
model <- loadModel(file)
source("/Users/ricard/git/scGFA/R/R/proportion_variance.R")
source("/Users/ricard/git/scGFA/R/R/view_vs_factor.R")
PlotViewVsFactor(model, color=colorRampPalette(c("grey100", "grey0"))(100), title="", cluster_cols=F, cluster_rows=F, show_rownames=T, show_colnames=T,
legend=T, treeheight_row=20, treeheight_col=20, fontsize_row=20, fontsize_col=20, cellheight=NA, cellwidth=NA, outfile=NA)
model@Expectations
legend=T, treeheight_row=20, treeheight_col=20, fontsize_row=20, fontsize_col=20, cellheight=NA, cellwidth=NA, outfile=NA)
model@Expectations$alpha
names(model@Expectations)
model@Expectations$Alpha
names(model)
model
model@getData
model@getTrainingData()
model@TrainingData
model@Data
names(model@Data)
model@Data[["E3.5"]]
colMeans(model@Data[["E3.5"]])
rowMeans(model@Data[["E3.5"]])
model@Data[["E3.5"]]
model@Expectations$Z
model@Expectations$Z[,1]
model@Expectations$Z$E[,1]
a <- model@Expectations$Z$E[,1]
names(a) <- sapply(names(model@Data), function(x) stringr::str_c(x,"_",colnames(model@Data[[x]]))
)
names(a) <- sapply(names(model@Data), function(x) stringr::str_c(x,"_",colnames(model@Data[[x]]))
)
names(a) <- sapply(names(model@Data), function(x) stringr::str_c(x,"_",colnames(model@Data[[x]])))
a
x = "E3.5"
colnames(model@Data[[x]])
stringr::str_c(x,"_",colnames(model@Data[[x]]))
sapply(model@Data, colnames)
names(a) <- unlist(sapply(model@Data, colnames))
a
names(a) <- unlist(sapply(model@Data, rownames))
a <- model@Expectations$Z$E[,1]
names(a) <- unlist(sapply(model@Data, rownames))
length(a)
dim(model@Expectations$Z$E)
names(a) <- rownames(model@Data[1])
a
sort(a)
class(a)
names(a) <- rownames(model@Data[1])
a
names(a)
rownames(model@Data[1])
names(a) <- rownames(model@Data[[1]])
a
sort(a)
model@Expectations$W$E
names(model@Expectations$W)
model@Expectations$W
model@Expectations$SW
names(model@Expectations$SW)
names(model@Expectations$SW[["E3.5"]])
dim(model@Expectations$SW[["E3.5"]]$E)
b <- model@Expectations$SW[["E3.5"]]$E[,1]
names(a) <- colnames(model@Data[["E3.5"]])
names(b) <- colnames(model@Data[["E3.5"]])
b
b1 <- model@Expectations$SW[["E3.5"]]$E[,1]
names(b) <- colnames(model@Data[["E3.5"]])
b2 <- model@Expectations$SW[["E4.5"]]$E[,1]
names(b) <- colnames(model@Data[["E4.5"]])
b3 <- model@Expectations$SW[["E4.5"]]$E[,1]
names(b) <- colnames(model@Data[["E4.5"]])
b1 <- model@Expectations$SW[["E3.5"]]$E[,1]
names(b1) <- colnames(model@Data[["E3.5"]])
b2 <- model@Expectations$SW[["E4.5"]]$E[,1]
names(b2) <- colnames(model@Data[["E4.5"]])
b3 <- model@Expectations$SW[["E4.5"]]$E[,1]
names(b3) <- colnames(model@Data[["E4.5"]])
b3
b2
b3
b1
b2
b3
b1
b2
b3
sce
write.table(exprs(sce), file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/all.txt", quote=F, sep=" ", row.names=T, col.names=T)
file = "/Users/ricard/git/gastrulation/expr/scGFA/expr/out/singleview0.hdf5"
model <- loadModel(file)
model@Expectations$Alpha
model@Expectations$Alpha$E
model@Expectations$Alpha$all$E
w1 <- model@Expectations$SW[["all"]]$E[,1]
w3 <- model@Expectations$SW[["all"]]$E[,3]
w1
w2
w3
sort(w3)
names(w3) <- rownames(model@Data[["all"]])
w3
names(w3) <- colnames(model@Data[["all"]])
w3
sort(w3)
colnames(sce)[sce$stage=="E6.75"]
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
unique(sce$stage)
# Split according to stages
E3.5 <- exprs(filter(sce,stage=="E3.5"))
E4.5 <- exprs(filter(sce,stage=="E4.5"))
E5.5 <- exprs(filter(sce,stage=="E5.5"))
write.table(E3.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E3.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E4.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E4.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E5.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E5.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(exprs(sce), file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/all.txt", quote=F, sep=" ", row.names=T, col.names=T)
dim(exprs(sce))
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
dim(sce)
source("/Users/ricard/git/scGFA/R/R/loadModel.R")
file = "/Users/ricard/git/gastrulation/expr/scGFA/expr/out/singleview0.hdf5"
model <- loadModel(file)
model@Expectations$Alpha$all$E
w1 <- model@Expectations$SW[["all"]]$E[,1]
w3 <- model@Expectations$SW[["all"]]$E[,3]
w1
w2
w3
names(w3) <- colnames(model@Data[["all"]])
sort(w3)
z1 <- model@Expectations$Z$E[,1]
z1
names(z3) <- rownames(model@Data[["all"]])
z3 <- model@Expectations$Z$E[,3]
names(z3) <- rownames(model@Data[["all"]])
z3
sort(z3)
max(z3)
sort(z3)
sort(z3, decreasing=T)
sort(abs(z3), decreasing=T)
sort(abs(z3), decreasing=F)
data.frame(sample=names(w3), weights=w3)
asd <- data.frame(sample=names(w3), weights=w3)
View(asd)
sapply(names(w3), function(x) strsplit(x,"_")[[1]][1])
asd <- data.frame(sample=names(w3), weights=w3, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
#######
View(asd)
asd <- data.frame(sample=names(w3), weights=abs(w3), stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
#######
View(asd)
library(ggplot2)
library(ggplot2)
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
sort(w3)
sort(z3)
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
View(pData(sce))
unique(pData(sce)$clusCT)
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
# Split according to stages
E3.5 <- exprs(filter(sce,stage=="E3.5" & clusCT=="ICM"))
E4.5 <- exprs(filter(sce,stage=="E4.5" & clusCT=="EPI"))
E5.5 <- exprs(filter(sce,stage=="E5.5" & clusCT=="EPI"))
dim(E3.5)
dim(E4.5)
dim(E5.5)
write.table(E3.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E3.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E4.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E4.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E5.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E5.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(exprs(sce), file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/all.txt", quote=F, sep=" ", row.names=T, col.names=T)
sce <- readRDS("/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/expr_sceset.rds")
# Split according to stages
E3.5 <- exprs(filter(sce,stage=="E3.5" & clusCT=="ICM"))
E4.5 <- exprs(filter(sce,stage=="E4.5" & clusCT=="EPI"))
E5.5 <- exprs(filter(sce,stage=="E5.5" & clusCT=="EPI"))
all <- cbind(exprs(E3.5),exprs(E4.5),exprs(E5.5))
all <- cbind(E3.5,E4.5,E5.5)
write.table(E3.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E3.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E4.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E4.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(E5.5, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/E5.5.txt", quote=F, sep=" ", row.names=T, col.names=T)
write.table(all, file="/Users/ricard/git/gastrulation/expr/scGFA/expr/filt_data/all.txt", quote=F, sep=" ", row.names=T, col.names=T)
dim(all)
dim(E3.5)
dim(E4.5)
dim(E5.5)
source("/Users/ricard/git/scGFA/R/R/loadModel.R")
file = "/Users/ricard/git/gastrulation/expr/scGFA/expr/out/singleview0.hdf5"
model <- loadModel(file)
model@Expectations$Alpha$all$E
z1 <- model@Expectations$Z$E[,1]
w1 <- model@Expectations$SW[["all"]]$E[,1]
z3 <- model@Expectations$Z$E[,3]
names(z3) <- rownames(model@Data[["all"]])
sort(abs(z3), decreasing=F)
w3 <- model@Expectations$SW[["all"]]$E[,3]
names(w3) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w3), weights=abs(w3), stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
library(ggplot2)
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
E3.5_markers <- c("Bhmt","Crxos1","Calcoco2","Sfn","Tet2","Klf5","Tex19.1")
E3.5_markers <- c("Bhmt","Crxos1","Calcoco2","Sfn","Tet2","Klf5","Tex19.1")
w3[E3.5_markers]
E3.5_markers
w3
z3[E3.5_markers]
z3
z3["Crxos1"]
"Crxos1" %in% names(z3)
"Crxos1" %in% rownames(sce)
sce <- readRDS("~/data/gastrulation/expr/processed/expr_sceset.rds")
"Crxos1" %in% rownames(sce)
View(fData(sce))
"Bhmt" %in% rownames(sce)
"Calcoco1" %in% names(z3)
"Calcoco2" %in% names(z3)
"Sfn" %in% names(z3)
names(z3)
foo <- data.frame(gene=names(z3), value=z3)
foo
View(foo)
?plotExpression
sce <- readRDS("~/data/gastrulation/expr/processed/expr_sceset.rds") %>% filter(stage %in% c("E3.5","E4.5","E5.5") & clusCT %in% c("ICM","EPI"))
plotExpression(sce, x=stage)
plotExpression(sce, x=stage, features=c("Eno1b","Pgk1","Stab1"))
colnames(pData(sce))
plotExpression(sce, x="stage"", features=c("Eno1b","Pgk1","Stab1"))
plotExpression(sce, x="stage", features=c("Eno1b","Pgk1","Stab1"))
plotExpression(sce, x="stage", features=c("Gabarapl2","Slc1a1","Vnn1"))
plotExpression(sce, x="stage", features=c("Bhmt2"))
asd <- data.frame(sample=names(w3), weights=w3, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
z2 <- model@Expectations$Z$E[,2]
names(z3) <- rownames(model@Data[["all"]])
w2 <- model@Expectations$SW[["all"]]$E[,2]
names(w2) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w2), weights=w2, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
z2 <- model@Expectations$Z$E[,2]
names(z2) <- rownames(model@Data[["all"]])
w2 <- model@Expectations$SW[["all"]]$E[,2]
names(w2) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w2), weights=w2, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
z2 <- model@Expectations$Z$E[,2]
names(z2) <- rownames(model@Data[["all"]])
w2 <- model@Expectations$SW[["all"]]$E[,2]
names(w2) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w2), weights=w2, stage=sapply(names(w2), function(x) strsplit(x,"_")[[1]][1]))
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
z1 <- model@Expectations$Z$E[,1]
names(z1) <- rownames(model@Data[["all"]])
w1 <- model@Expectations$SW[["all"]]$E[,1]
names(w1) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w1), weights=w1, stage=sapply(names(w1), function(x) strsplit(x,"_")[[1]][1]))
z3 <- model@Expectations$Z$E[,3]
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
z4 <- model@Expectations$Z$E[,4]
names(z4) <- rownames(model@Data[["all"]])
w4 <- model@Expectations$SW[["all"]]$E[,4]
names(w4) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w4), weights=w4, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
z4 <- model@Expectations$Z$E[,4]
names(z4) <- rownames(model@Data[["all"]])
w4 <- model@Expectations$SW[["all"]]$E[,4]
names(w4) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w4), weights=w4, stage=sapply(names(w3), function(x) strsplit(x,"_")[[1]][1]))
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
foo <- data.frame(gene=names(z4), value=z4)
View(foo)
plotExpression(sce, x="stage", features=c("Cldn7","Zcrb1","Phgdh"))
plotExpression(sce, x="stage", features=c("Manba","Nr0b1","Ube2dnl1"))
plotExpression(sce, x="stage", features=c("Mylpf","Morc1","Manba"))
plotExpression(sce, x="stage", features=c("Adprh"))
model@Expectations$Alpha$all$E
z1 <- model@Expectations$Z$E[,1]
names(z1) <- rownames(model@Data[["all"]])
w1 <- model@Expectations$SW[["all"]]$E[,1]
names(w1) <- colnames(model@Data[["all"]])
asd <- data.frame(sample=names(w1), weights=w1, stage=sapply(names(w1), function(x) strsplit(x,"_")[[1]][1]))
ggplot(asd, aes(x=stage, y=weights)) +
geom_boxplot()
foo <- data.frame(gene=names(z1), value=z1)
View(foo)
